# –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å—á–µ—Ç–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å–µ–π —Å –∫–∞–º–µ—Ä –Ω–∞–±–ª—é–¥–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç YOLOv8 –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –ª—é–¥–µ–π, —Ç—Ä–µ–∫–∏–Ω–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π, –ø–æ–¥—Å—á–µ—Ç –≤—Ö–æ–¥—è—â–∏—Ö/–≤—ã—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ –ª–∏–Ω–∏—é IN/OUT –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–ø–ª–æ–≤—ã—Ö –∫–∞—Ä—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéØ **–î–µ—Ç–µ–∫—Ü–∏—è –ª—é–¥–µ–π**: –û–±—É—á–µ–Ω–∏–µ YOLOv8 —Å –Ω—É–ª—è –Ω–∞ COCO –¥–∞—Ç–∞—Å–µ—Ç–µ (–∫–ª–∞—Å—Å "person")
- üìä **–ü–æ–¥—Å—á–µ—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π**: –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª—é–¥–µ–π –Ω–∞ –∫–∞–∂–¥–æ–º –∫–∞–¥—Ä–µ
- üîÑ **–¢—Ä–µ–∫–∏–Ω–≥**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª—é–¥–µ–π –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏
- üö™ **IN/OUT –ø–æ–¥—Å—á–µ—Ç**: –ü–æ–¥—Å—á–µ—Ç –≤—Ö–æ–¥—è—â–∏—Ö –∏ –≤—ã—Ö–æ–¥—è—â–∏—Ö –ª—é–¥–µ–π —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –ª–∏–Ω–∏—é
- üó∫Ô∏è **–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π
- üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã**: –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
CrowdCounting/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ coco/              # COCO –¥–∞—Ç–∞—Å–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ videos/            # –í—Ö–æ–¥–Ω—ã–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ results/           # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ models/                # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ configs/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ train.py          # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ inference.py      # –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ
‚îÇ   ‚îú‚îÄ‚îÄ tracking.py       # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏ –ø–æ–¥—Å—á–µ—Ç IN/OUT
‚îÇ   ‚îú‚îÄ‚îÄ visualize.py      # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ heatmap.py        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ setup_line.py     # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–Ω–∏–∏ IN/OUT
‚îÇ   ‚îú‚îÄ‚îÄ prepare_coco.py   # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ COCO –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ utils.py          # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ .gitignore
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- CUDA (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞)
- 20+ GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –¥–ª—è COCO –¥–∞—Ç–∞—Å–µ—Ç–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ COCO –¥–∞—Ç–∞—Å–µ—Ç–∞

–°–∫–∞—á–∞–π—Ç–µ COCO –¥–∞—Ç–∞—Å–µ—Ç —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞: https://cocodataset.org/#download

–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã:
- `train2017.zip` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- `val2017.zip` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `annotations_trainval2017.zip` - –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏

–†–∞—Å–ø–∞–∫—É–π—Ç–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä `data/coco/`.

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏:

```bash
# Windows:
py src/prepare_coco.py --coco_dir data/coco --output_dir data/coco/yolo_format

# Linux/Mac:
python src/prepare_coco.py --coco_dir data/coco --output_dir data/coco/yolo_format
```

–°–∫—Ä–∏–ø—Ç:
- –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å "person" –∏–∑ COCO
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç YOLO
- –†–∞–∑–¥–µ–ª—è–µ—Ç –Ω–∞ train/val (80/20)
- –°–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è YOLOv8

### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è –≤ `configs/train_config.yaml`, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
# Windows:
py src/train.py --config configs/train_config.yaml

# Linux/Mac:
python src/train.py --config configs/train_config.yaml
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ:
- `model.size`: —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏ ('n', 's', 'm', 'l', 'x')
- `training.epochs`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
- `training.batch_size`: —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
- `training.device`: **'cuda'** (–æ–±—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç GPU!)

**‚ö†Ô∏è –í–ê–ñ–ù–û**: –û–±—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç GPU —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA. –ï—Å–ª–∏ GPU –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –æ–±—É—á–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è. –°–º. INSTALL_GPU.md –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PyTorch —Å CUDA.

**–í–∞–∂–Ω–æ**: –û–±—É—á–µ–Ω–∏–µ —Å –Ω—É–ª—è —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤:
- GPU —Å 8+ GB VRAM —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
- –û–±—É—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –¥–∞–∂–µ –Ω–∞ GPU
- –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–Ω–∏–∏ IN/OUT

–ü–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤–∏–¥–µ–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–∏–Ω–∏—é IN/OUT:

```bash
# Windows:
py src/setup_line.py --video data/videos/your_video.mp4 --output configs/line_config.yaml

# Linux/Mac:
python src/setup_line.py --video data/videos/your_video.mp4 --output configs/line_config.yaml
```

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:
- –¢–æ—á–∫–∏ —Å—Ç–∞–≤–∏—Ç—å —Å–≤–µ—Ä—Ö—É —Å–Ω–∏–∑, –µ—Å–ª–∏ –≤—Ö–æ–¥ —Å–ª–µ–≤–∞
- –û—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ —Å –ø–µ—Ä–≤—ã–º –∫–∞–¥—Ä–æ–º –≤–∏–¥–µ–æ
- –õ–µ–≤—ã–π –∫–ª–∏–∫: –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É (–Ω—É–∂–Ω–æ 2 —Ç–æ—á–∫–∏)
- –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫: —Å–±—Ä–æ—Å–∏—Ç—å —Ç–æ—á–∫–∏
- 's': —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- 'r': —Å–±—Ä–æ—Å–∏—Ç—å —Ç–æ—á–∫–∏
- 'q' –∏–ª–∏ ESC: –≤—ã–π—Ç–∏

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ

–û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤–∏–¥–µ–æ —Å –ø–æ–¥—Å—á–µ—Ç–æ–º –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π:

```bash
# Windows:
py src/inference.py --video data/videos/your_video.mp4 --model models/yolov8n_person_best.pt --line_config configs/line_config.yaml --output_dir data/results

# Linux/Mac:
python src/inference.py --video data/videos/your_video.mp4 --model models/yolov8n_person_best.pt --line_config configs/line_config.yaml --output_dir data/results
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `--video`: –ø—É—Ç—å –∫ –≤—Ö–æ–¥–Ω–æ–º—É –≤–∏–¥–µ–æ
- `--model`: –ø—É—Ç—å –∫ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
- `--line_config`: –ø—É—Ç—å –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ª–∏–Ω–∏–∏ IN/OUT (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `--output_dir`: –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `--no-tracking`: –æ—Ç–∫–ª—é—á–∏—Ç—å —Ç—Ä–µ–∫–∏–Ω–≥ –∏ –ø–æ–¥—Å—á–µ—Ç IN/OUT
- `--no-heatmap`: –æ—Ç–∫–ª—é—á–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π
- JSON —Ñ–∞–π–ª —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞)

### 5. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:

```bash
# Windows:
py src/visualize.py --stats data/results/your_video_stats.json --output_dir data/results/dashboard

# Linux/Mac:
python src/visualize.py --stats data/results/your_video_stats.json --output_dir data/results/dashboard
```

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:
- –ì—Ä–∞—Ñ–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª—é–¥–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- –ì—Ä–∞—Ñ–∏–∫ –≤—Ö–æ–¥—è—â–∏—Ö/–≤—ã—Ö–æ–¥—è—â–∏—Ö –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è (`configs/train_config.yaml`)

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `data`: –ø—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ YOLO
- `model.size`: —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏ ('n', 's', 'm', 'l', 'x')
- `training.epochs`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
- `training.batch_size`: —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
- `training.img_size`: —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (640, 1280 –∏ —Ç.–¥.)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–∏–Ω–∏–∏ IN/OUT (`configs/line_config.yaml`)

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º `setup_line.py`:
```yaml
line:
  point1:
    x: 100
    y: 200
  point2:
    x: 500
    y: 200
video_path: data/videos/your_video.mp4
```

## –§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### JSON —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```json
{
  "video_path": "data/videos/video.mp4",
  "total_frames": 1000,
  "fps": 30.0,
  "resolution": {"width": 1920, "height": 1080},
  "frame_statistics": [
    {
      "frame": 0,
      "count": 5,
      "detections": 5,
      "in_count": 0,
      "out_count": 0
    }
  ],
  "summary": {
    "max_count": 10,
    "min_count": 0,
    "avg_count": 5.2
  },
  "tracking": {
    "total_in": 25,
    "total_out": 20,
    "current_inside": 5
  }
}
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- **–î–ª—è –æ–±—É—á–µ–Ω–∏—è**: GPU —Å 8+ GB VRAM, –º–æ–¥–µ–ª—å 'n' –∏–ª–∏ 's'
- **–î–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞**: GPU —Å 4+ GB VRAM, –º–æ–¥–µ–ª—å 'n' –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–ª–∏ 'm' –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
- **CPU –∏–Ω—Ñ–µ—Ä–µ–Ω—Å**: –≤–æ–∑–º–æ–∂–µ–Ω, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω—ã–π (1-5 FPS)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å 'n' (nano) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –£–º–µ–Ω—å—à–∏—Ç–µ `img_size` –≤ –∫–æ–Ω—Ñ–∏–≥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 416 –≤–º–µ—Å—Ç–æ 640)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –≤–∏–¥–µ–æ –ø–æ —á–∞—Å—Ç—è–º –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏: "CUDA out of memory"

- –£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ ('n' –≤–º–µ—Å—Ç–æ 's')
- –£–º–µ–Ω—å—à–∏—Ç–µ `img_size`

### –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏

- –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å –±–æ–ª—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ ('m' –∏–ª–∏ 'l')
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–µ–∫–∏–Ω–≥–æ–º

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–∏–Ω–∏—è IN/OUT –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ª—é–¥–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç –ª–∏–Ω–∏—é
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `max_distance` –≤ `tracking.py` –¥–ª—è –ª—É—á—à–µ–≥–æ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è —Ç—Ä–µ–∫–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.

## –ê–≤—Ç–æ—Ä—ã

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥—Å—á–µ—Ç–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞.

## –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [Ultralytics YOLOv8](https://github.com/ultralytics/ultralytics) - –¥–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
- [COCO Dataset](https://cocodataset.org/) - –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

